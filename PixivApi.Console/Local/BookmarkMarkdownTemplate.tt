<#@ import namespace="System" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="PixivApi.Core" #>
<#
ArtworkCount = 0;
foreach (var artwork in Artworks)
{
    ++ArtworkCount;
    var user = UserDictionary[artwork.UserId];
    var time = artwork.FileDate;
#>
# [<#= artwork.Title #>](https://www.pixiv.net/artworks/<#= artwork.Id #>)

<#if (user.IsFollowed) {#>👩‍🎨<#} if (artwork.IsBookmarked) {#>⭐<#}#> [<#= user.Name #>](https://www.pixiv.net/users/<#= user.Id #>) 👁 <#= artwork.TotalView #> ♡ <#= artwork.TotalBookmarks #> 📅 <#= time.Year #>-<#= time.Month #>-<#= time.Day #><# if (artwork.IsXRestricted) {#> 🔞<#} #>

<#
    var folder = $"{RelativePathToOriginal}{IOUtility.GetHashPath(artwork.Id)}";
    if (artwork.Type == ArtworkType.Ugoira)
    {
        var original = $"{folder}{artwork.GetUgoiraOriginalFileName()}";
        if (File.Exists(original))
        {
#>

![<#= artwork.Title #> - ugoira](<#= original #> "<#= artwork.Id #>")
<#
        }
        else
        {
            var thumbnail = $"{RelativePathToThumbnail}{IOUtility.GetHashPath(artwork.Id)}{artwork.GetUgoiraThumbnailFileName()}";
#>

⚠ <#= artwork.UgoiraFrames?.Length ?? 0 #>
![<#= artwork.Title #>](<#= thumbnail #> "<#= artwork.Id #>")        
<#
        }
    }
    else
    {
        var firstOriginal = $"{folder}{artwork.GetNotUgoiraOriginalFileName(0)}";
        if (File.Exists(firstOriginal))
        {
#>

![<#= artwork.Title #> - 0](<#= firstOriginal #> "<#= artwork.Id #>")
<#
            for (uint i = 1; i < artwork.PageCount; ++i)
            {
                if (i + 1U == artwork.PageCount && artwork.ExtraHideLast)
                {
                    break;
                }
#>

![<#= artwork.Title #> - <#= i #>](<#= folder #><#= artwork.GetNotUgoiraOriginalFileName(i) #> "<#= artwork.Id #>")
<#
            }
        }
        else
        {
            var thumbnail = $"{RelativePathToThumbnail}{IOUtility.GetHashPath(artwork.Id)}{artwork.GetNotUgoiraThumbnailFileName(0)}";
#>

⚠ <#= artwork.PageCount #>
![<#= artwork.Title #>](<#= thumbnail #> "<#= artwork.Id #>")        
<#
        }
    }
    if (!string.IsNullOrWhiteSpace(artwork.Caption)) {
#>

<#= artwork.Caption #>
<#
    }
    
    if (artwork.Tags.Length != 0)
    {
#>

<#
        foreach (var tag in artwork.Tags)
        {#> **<#= TagSet.Values[tag] #>**<#}
    }
#>


<#}#>
